<!-- Search & Filters -->
<%= form_with url: root_path, method: :get, local: true, 
  data: { controller: "search", action: "change->search#submit", search_target: "form" } do 
%>
  <div class="border-b border-gray-200 bg-white px-6 py-4">
    <div class="flex flex-col gap-4 lg:flex-row lg:items-end lg:justify-between">

      <!-- Left: Search -->
      <div class="relative w-full lg:max-w-sm">
        <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3 text-gray-400">
          <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M21 21l-4.35-4.35m1.6-5.15a7 7 0 11-14 0 7 7 0 0114 0z" />
          </svg>
        </div>
        <%= search_field_tag :query, params[:query], 
          placeholder: "Search events...",
          class: "block w-full rounded-md border border-gray-300 py-2 pl-10 pr-3 text-sm
                focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500" 
        %>
      </div>

      <!-- Right: Filters -->
      <div class="grid w-full grid-cols-2 gap-3 sm:grid-cols-4 lg:flex lg:w-auto lg:items-end lg:gap-3">

        <!-- Start Date -->
        <div class="flex flex-col">
          <label class="text-xs font-medium text-gray-600">Start date</label>
          <%= date_field_tag :start_date, params[:start_date], 
            class: "rounded-md border border-gray-300 px-3 py-2 text-sm
                  focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"
          %>
        </div>

        <!-- End Date -->
        <div class="flex flex-col">
          <label class="text-xs font-medium text-gray-600">End date</label>
          <%= date_field_tag :end_date, params[:end_date], 
            class: "rounded-md border border-gray-300 px-3 py-2 text-sm
                  focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"
          %>
        </div>

        <!-- Location -->
        <div class="flex flex-col">
          <label class="text-xs font-medium text-gray-600">Location</label>
          <%= text_field_tag :location, params[:location], placeholder: "e.g. Berlin", 
            class: "rounded-md border border-gray-300 px-3 py-2 text-sm
                  focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500" 
          %>
        </div>

        <!-- Status -->
        <div class="flex flex-col">
          <label class="text-xs font-medium text-gray-600">Status</label>
          <%= select_tag :status, 
            options_for_select([["All", ""], ["Draft", "draft"], ["Published", "published"], ["Cancelled", "cancelled"], ["Out of Stock", "out_of_stock"], ["Archived", "archived"]], 
            params[:status]), 
            class: "rounded-md border border-gray-300 px-3 py-2 text-sm
                  focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"
          %>
        </div>

      </div>
    </div>
  </div>
<% end %>

<%= render 'shared/table', 
  records: @events, 
  columns: @columns, 
  pagination: {
    current_page: @current_page,
    total_pages: @total_pages,
    total_count: @total_events,
    path_helper: ->(page) { root_path(params.to_unsafe_h.merge(page: page)) }
  } 
%>

